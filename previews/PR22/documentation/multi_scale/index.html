<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Chemo-Mechanical Problem - Multi-Scale · Chemo-mechanical.jl</title><meta name="title" content="Chemo-Mechanical Problem - Multi-Scale · Chemo-mechanical.jl"/><meta property="og:title" content="Chemo-Mechanical Problem - Multi-Scale · Chemo-mechanical.jl"/><meta property="twitter:title" content="Chemo-Mechanical Problem - Multi-Scale · Chemo-mechanical.jl"/><meta name="description" content="Documentation for Chemo-mechanical.jl."/><meta property="og:description" content="Documentation for Chemo-mechanical.jl."/><meta property="twitter:description" content="Documentation for Chemo-mechanical.jl."/><meta property="og:url" content="https://github.com/DRollin/YiyuanStudentProject.jl.git/documentation/multi_scale/"/><meta property="twitter:url" content="https://github.com/DRollin/YiyuanStudentProject.jl.git/documentation/multi_scale/"/><link rel="canonical" href="https://github.com/DRollin/YiyuanStudentProject.jl.git/documentation/multi_scale/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Chemo-mechanical.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../">Documentation overview</a></li><li><a class="tocitem" href="../fine_scale/">Chemo-Mechanical Problem - Fine-Scale</a></li><li class="is-active"><a class="tocitem" href>Chemo-Mechanical Problem - Multi-Scale</a><ul class="internal"><li><a class="tocitem" href="#Variationally-Consistent-Homogenization-(VCH)"><span>Variationally Consistent Homogenization (VCH)</span></a></li><li><a class="tocitem" href="#Upscaling"><span>Upscaling</span></a></li><li><a class="tocitem" href="#Weak-Format-Macro-Scale"><span>Weak Format Macro Scale</span></a></li><li><a class="tocitem" href="#Boundary-Condition-on-RVE"><span>Boundary Condition on RVE</span></a></li><li><a class="tocitem" href="#Time-Stepping"><span>Time Stepping</span></a></li></ul></li><li><a class="tocitem" href="../challenge_problem/">Challenges and Problems</a></li><li><a class="tocitem" href="../reference/">References</a></li></ul></li><li><a class="tocitem" href="../../examples/example_1/">Example</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/">Reference overview</a></li><li><a class="tocitem" href="../../reference/types/">Types</a></li><li><a class="tocitem" href="../../reference/sub_scale/">Sub Scale</a></li><li><a class="tocitem" href="../../reference/upscaling/">Upscaling</a></li><li><a class="tocitem" href="../../reference/macro_scale/">Macro Scale</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li class="is-active"><a href>Chemo-Mechanical Problem - Multi-Scale</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Chemo-Mechanical Problem - Multi-Scale</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/DRollin/YiyuanStudentProject.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/DRollin/YiyuanStudentProject.jl/blob/main/docs/src/documentation/multi_scale.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="documentation-multi-scale"><a class="docs-heading-anchor" href="#documentation-multi-scale">Chemo-Mechanical Problem - Multi-Scale</a><a id="documentation-multi-scale-1"></a><a class="docs-heading-anchor-permalink" href="#documentation-multi-scale" title="Permalink"></a></h1><p>A full-scale resolution of the material microstructure provides highly accurate results but is computationally expensive. To improve efficiency while preserving accuracy, a multi-scale approach is used. This method decomposes the original fine-scale problem into a homogeneous macro-scale model and a sub-scale RVE that fully captures the microstructure.</p><p><img src="../image.png" alt="alt text"/></p><p><em>Fig. 1</em>: Schematic diagram of decomposition of a fine scale problem using computational homogenization. </p><h2 id="Variationally-Consistent-Homogenization-(VCH)"><a class="docs-heading-anchor" href="#Variationally-Consistent-Homogenization-(VCH)">Variationally Consistent Homogenization (VCH)</a><a id="Variationally-Consistent-Homogenization-(VCH)-1"></a><a class="docs-heading-anchor-permalink" href="#Variationally-Consistent-Homogenization-(VCH)" title="Permalink"></a></h2><p>By replacing integrands by running averaging on the RVE, the homogenization is introduced. The unknown fields are decomposed using the assumption of a hierachical decomposition. </p><h3 id="Running-Averaging-on-RVE"><a class="docs-heading-anchor" href="#Running-Averaging-on-RVE">Running Averaging on RVE</a><a id="Running-Averaging-on-RVE-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Averaging-on-RVE" title="Permalink"></a></h3><p>The running averaging operator for a quantity <span>$\diamond$</span>  is denoted for volume and surface as following:</p><p class="math-container">\[\begin{align}
\langle \diamond \rangle _{\square} &amp;:= \frac{1}{| \Omega _{\square}|} \int_{{ \Omega} _{\square}} \diamond \ d  \Omega

\\
\langle \langle \diamond \rangle \rangle _{\square} &amp;:= \frac{1}{|\Gamma _{\square}|} \int_{{\Gamma} _{\square}} \diamond \ d \Gamma
\end{align}\]</p><p>where the corresponding homogenized macro scale field <span>$\bar \diamond$</span> is often defined as <span>$\bar \diamond := \langle \diamond \rangle _{\square}$</span> . </p><h3 id="Hierarchical-Decomposition"><a class="docs-heading-anchor" href="#Hierarchical-Decomposition">Hierarchical Decomposition</a><a id="Hierarchical-Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Hierarchical-Decomposition" title="Permalink"></a></h3><p>For the chemo-mechanical problem, displacement <span>$\boldsymbol u$</span> and chemical potential $ \mu$ can be decomposed into (smooth) macro-scale <span>$\diamond ^{M}$</span> and (fluctuating) sub-scale <span>$\diamond ^{s}$</span> parts, where the macro-scale parts will be prescribed using Taylor expansions on each RVE. Since the concentration $ c$ is only a local quantity, no such decomposition is needed for it.</p><p>Thus, using first order Taylor expansion (linear variation) the homogenized fields <span>$\bar{\boldsymbol u}$</span> and <span>$\bar{ \mu}$</span> are prolonged over the RVE as follows:</p><p class="math-container">\[\begin{align}
\boldsymbol u^\text{M}[\bar{\boldsymbol u}](\bar{\boldsymbol x}, \boldsymbol x ) &amp;= \bar{\boldsymbol u}(\bar{\boldsymbol x}) + \bar{\boldsymbol \xi}(\bar{\boldsymbol x}) \cdot [x - \bar{\boldsymbol x}], \ \ \bar{\boldsymbol \xi} := \bar{\boldsymbol u}  \otimes \boldsymbol \nabla, &amp; \ \boldsymbol x \in  \Omega_\square

\\

\mu^\text{M}[\bar{\boldsymbol \mu}](\bar{\boldsymbol x}, \boldsymbol x ) &amp;= \bar{\boldsymbol \mu}(\bar{\boldsymbol x}) + \bar{\boldsymbol \zeta}(\bar{\boldsymbol x}) \cdot [x - \bar{\boldsymbol x}], \ \ \bar{\boldsymbol \zeta} := \boldsymbol \nabla \bar{\boldsymbol \mu}  , &amp; \ x \in \Omega_\square
\end{align}\]</p><p>where <span>$\bar{\boldsymbol x}$</span> is the centriod.</p><h2 id="Upscaling"><a class="docs-heading-anchor" href="#Upscaling">Upscaling</a><a id="Upscaling-1"></a><a class="docs-heading-anchor-permalink" href="#Upscaling" title="Permalink"></a></h2><p>After inserting the hierarchical decomposition <span>$\boldsymbol u = \boldsymbol u ^\text{M} + \boldsymbol u ^\text{s} \in \mathbb U ^\text{M} \oplus \mathbb U ^\text{s}$</span> and <span>$\mu = \mu ^\text{M} + \mu ^\text{s} \in \mathbb M ^\text{M} \oplus \mathbb M ^\text{s}$</span> and the upsacling assumption <span>$\bar \diamond := \langle \diamond \rangle _{\square}$</span> into the fine scale week form, the two scale problem is defined:</p><p class="math-container">\[\begin{align}
\int_{\Omega} \langle \boldsymbol \sigma (\boldsymbol \varepsilon[\boldsymbol u ^{M}[\bar {\boldsymbol u}] + \boldsymbol u ^\text{s}],c ^\text{s}) : \boldsymbol \varepsilon[\boldsymbol u ^{M}[ \delta \bar {\boldsymbol u} ]+ \delta\boldsymbol u ^\text{s}] \rangle _\square \ d\Omega  &amp;=  \int_{\Gamma_N^\text{(u)}} \boldsymbol t^\text{p} \cdot \delta \bar{\boldsymbol u} \ d\Gamma
&amp;\
\forall \delta (\bar{\boldsymbol u}, {\boldsymbol u} ^\text{s}) &amp;\in \bar {\mathbb{U}}^\text{0} \oplus \mathbb U ^\text{s}
\\
\int_{\Omega} \langle \dot{c} ^\text{s} \ [\mu ^\text{M} [\delta \bar{\mu}] + \delta\mu^\text{s}] \rangle _\square \ d\Omega - \int_{\Omega} \boldsymbol \langle j(\boldsymbol \nabla[\mu ^\text{M} [\bar{\mu}] + \mu^\text{s}]) \cdot \boldsymbol \nabla[\mu ^\text{M} [\delta \bar{\mu}] + \delta\mu^\text{s}] \rangle _\square \ d\Omega
&amp;=  \int_{\Gamma_N^{\mu}} \boldsymbol h^\text{p} \delta \bar{\mu} \ d\Gamma
&amp;\
\forall \delta (\bar{\mu}, {\mu} ^\text{s}) &amp;\in \bar {\mathbb{M}}^\text{0} \oplus \mathbb M ^\text{s}
\\
\int_{\Omega} \langle ([\mu ^\text{M} [\bar{\mu}] + \mu^\text{s}] - \mu^\text{en}(\boldsymbol \varepsilon[\boldsymbol u ^\text{M}[\bar {\boldsymbol u}] + \boldsymbol u ^\text{s}], c^\text{s})) \delta c^\text{s} \rangle _\square \ d\Omega
&amp;= 0
&amp;\
\forall \delta c^\text{s} &amp;\in \mathbb{C}^\text{0}
\end{align}\]</p><h2 id="Weak-Format-Macro-Scale"><a class="docs-heading-anchor" href="#Weak-Format-Macro-Scale">Weak Format Macro Scale</a><a id="Weak-Format-Macro-Scale-1"></a><a class="docs-heading-anchor-permalink" href="#Weak-Format-Macro-Scale" title="Permalink"></a></h2><p>By with setting <span>$\delta \boldsymbol u^\text{s}, \delta \mu^\text{s}, \delta c^\text{s}$</span> to 0, the globally coupled macro scale problem is established.</p><p class="math-container">\[\begin{align}
\int_{\Omega} \bar{\boldsymbol \sigma} : \boldsymbol \varepsilon[\delta \bar{\boldsymbol u}] \ d\Omega  &amp;=  \int_{\Gamma_N^{(u)}} \boldsymbol t^\text{p} \cdot \delta \bar{\boldsymbol u} \ d\Gamma
&amp;\
\forall \delta \bar{\boldsymbol u} \in \bar{\mathbb{U}}^{0}
\\
\int_{\Omega} \dot{\bar{ c}} \ \delta \bar{ \mu} \ d\Omega - \int_{\Omega} (\bar{\boldsymbol j} - \dot{\bar{ \boldsymbol c}}_\text{2}) \cdot \boldsymbol \nabla[\delta \bar{ \mu}] \ d\Omega
&amp;=  \int_{\Gamma_N^{(\mu)}} \boldsymbol h^\text{p} \delta \bar{ \mu} \ d \Gamma
&amp;\
\forall \delta \bar{ \mu} \in \bar{\mathbb{M}}^{0}
\end{align}\]</p><p>with the variationally consistent macro scale homogenized fields:</p><p class="math-container">\[\begin{align}
    \bar{\boldsymbol \sigma} &amp;:= \langle \boldsymbol \sigma \rangle _\square = \langle \boldsymbol E \colon [\boldsymbol \varepsilon[\boldsymbol u]-\boldsymbol \alpha^\text{ch}[ c - c_{ref}]] \rangle _\square
\\
    \bar{\boldsymbol j} &amp;:= \langle \boldsymbol j \rangle _\square = -\langle \boldsymbol M \cdot \boldsymbol \zeta[\boldsymbol \mu] \rangle _\square
\\
    \bar{ c} &amp;:= \langle  c \rangle _\square
\\
    \bar{ \boldsymbol c_{2}} &amp;:= \langle  c [\boldsymbol x - \bar{\boldsymbol x}] \rangle _\square
\end{align}\]</p><h2 id="Boundary-Condition-on-RVE"><a class="docs-heading-anchor" href="#Boundary-Condition-on-RVE">Boundary Condition on RVE</a><a id="Boundary-Condition-on-RVE-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Condition-on-RVE" title="Permalink"></a></h2><p>When fully adapting the microstructural details from the fine-scale problem at each macro-scale quadrature point, a consistent boundary condition must be established to align the two scales. Here the Dirichlet boundary condition is chosen as: </p><p class="math-container">\[\begin{align}
    \boldsymbol u &amp;= \bar{\boldsymbol u} + \bar{\boldsymbol \varepsilon} [\boldsymbol x - \bar{\boldsymbol x}]
    &amp;\
    \text{on} \  \boldsymbol \Gamma_{D}^{(u)}
\\
     \mu &amp;= \bar{\mu} + \bar{\boldsymbol \zeta} [\boldsymbol x - \bar{\boldsymbol x}]
     &amp;\
    \text{on} \  \boldsymbol \Gamma_{D}^{(\mu)}

\end{align}\]</p><p>Due to rigid body translation there is no resulting sub scale stress from macro scale deformation <span>$\bar{\boldsymbol u}$</span>. Therefore, for convenience <span>$\bar{\boldsymbol u}$</span> can be set to <span>$\boldsymbol 0$</span>.</p><h2 id="Time-Stepping"><a class="docs-heading-anchor" href="#Time-Stepping">Time Stepping</a><a id="Time-Stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Stepping" title="Permalink"></a></h2><p>For every time step, the RVE problem is going to be solved at the corresponding quadrature point. The four variationally consistent macro scale fields are updated using new RVE results at current time. New stiffness matrix <span>$\boldsymbol K^\text{n}$</span> is then computed with the new variationally consistent macro scale fields. A time dependent boundary condition is applied on both <span>$\boldsymbol K^\text{n}$</span> and <span>$\boldsymbol f^\text{n}$</span>.</p><p class="math-container">\[\begin{align}

\boldsymbol K^\text{n}(\bar{\boldsymbol \sigma}^\text{n}, 
    \bar{\boldsymbol j}^\text{n}, \dot{\bar{ c}}^\text{n}, \dot{\bar{\boldsymbol c_\text{2}}}^{n}) \boldsymbol a^\text{n} &amp;= \boldsymbol f^\text{n}
\\
\boldsymbol a^\text{n} &amp;= (\boldsymbol K^\text{n})^\text{-1} \boldsymbol f^\text{n}

\end{align}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fine_scale/">« Chemo-Mechanical Problem - Fine-Scale</a><a class="docs-footer-nextpage" href="../challenge_problem/">Challenges and Problems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 24 February 2025 10:00">Monday 24 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
